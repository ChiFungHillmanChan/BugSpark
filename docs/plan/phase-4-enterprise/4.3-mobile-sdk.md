# 4.3 Mobile SDK (React Native / Flutter)

## Priority: MEDIUM | Complexity: VERY HIGH

To compete with Instabug/Luciq ($249/mo) and Shake ($160/mo) in the mobile space, BugSpark needs native mobile SDKs. This is a major undertaking but opens a new market.

---

## Scope

### Phase 1: React Native SDK
- Shake gesture to open bug reporter
- Screenshot capture (native)
- Annotation overlay
- Device info collection (OS, device model, app version, memory, battery)
- Console log capture
- Network request interception
- Crash reporting
- Submit to BugSpark API

### Phase 2: Flutter SDK
- Same features as React Native
- Dart-native implementation

### Phase 3: Native iOS / Android SDKs
- Swift / Kotlin implementations
- Deepest integration possible

## Architecture

### React Native SDK Structure

```
packages/sdk-react-native/
  src/
    BugSpark.ts              # Main entry point
    BugSparkView.tsx          # Report modal component
    collectors/
      device-info.ts          # Device metadata
      console-interceptor.ts  # Console capture
      network-interceptor.ts  # Network capture
      crash-reporter.ts       # Uncaught exception handler
    ui/
      ReportModal.tsx         # Bug report form
      AnnotationView.tsx      # Screenshot annotation
      FloatingButton.tsx      # Floating action button
    native/
      ios/                    # Native iOS module
      android/                # Native Android module
  package.json
  tsconfig.json
```

### SDK API

```typescript
import BugSpark from '@bugspark/react-native';

// Initialize
BugSpark.init({
    projectKey: 'bsk_pub_xxx',
    endpoint: 'https://api.bugspark.dev/api/v1',
    shakeToReport: true,          // Shake gesture
    screenshotOnShake: true,      // Auto-screenshot
    collectConsole: true,
    collectNetwork: true,
    crashReporting: true,
});

// Identify user
BugSpark.identify({ id: '123', email: 'user@example.com' });

// Open reporter programmatically
BugSpark.open();

// Add custom metadata
BugSpark.setMetadata({ screen: 'ProfileScreen', userId: '123' });
```

### Native Module (Screenshot)

React Native's `captureScreen` or use native modules:

```swift
// iOS native module
@objc(BugSparkScreenshot)
class BugSparkScreenshot: NSObject {
    @objc func capture(_ resolve: RCTPromiseResolveBlock, reject: RCTPromiseRejectBlock) {
        DispatchQueue.main.async {
            let window = UIApplication.shared.keyWindow!
            UIGraphicsBeginImageContextWithOptions(window.bounds.size, false, UIScreen.main.scale)
            window.drawHierarchy(in: window.bounds, afterScreenUpdates: true)
            let image = UIGraphicsGetImageFromCurrentImageContext()
            UIGraphicsEndImageContext()

            let data = image?.pngData()
            let base64 = data?.base64EncodedString()
            resolve(base64)
        }
    }
}
```

## Implementation Steps

1. Create `packages/sdk-react-native` package
2. Implement core SDK (init, identify, open/close)
3. Implement device info collector
4. Implement console interceptor
5. Implement network interceptor (XMLHttpRequest + fetch)
6. Implement crash reporter (global error handler)
7. Implement screenshot capture (native module)
8. Create report modal UI (React Native components)
9. Create annotation overlay
10. Implement shake gesture detection
11. Create floating button component
12. Publish to npm as `@bugspark/react-native`
13. Create documentation and setup guide

## Considerations

- This is a very large scope project
- Consider starting with a React Native wrapper around the web widget (WebView-based) as an MVP
- Full native SDKs can follow based on demand
- Instabug charges $249/mo â€” there is room to compete at a lower price point
